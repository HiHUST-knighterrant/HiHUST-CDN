var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),DrawseeLoader;(function(){function c(n){return!n||n.length<4?!1:n[0]===31&&n[1]===139&&n[2]===8&&n[3]===0}function l(n){try{var t=new Zlib.Gunzip(n);return t.decompress()}catch(i){return n}}function a(n,t){var u=[],i;try{if(c(n)&&(n=l(n)),t===r.ArrayBuffer)u.push(n);else for(i=new f(n);!i.isEof();){var s=i.readInt32(),o=i.readInt32(),e=i.readBytes(o);c(e)?u.push(l(e)):u.push(e)}}catch(h){}return u}function et(n,t){try{return new i(a(n,t),n.length,null)}catch(r){return new i([],0,null)}}function ot(n,t){return new Promise(function(r){try{var u=a(n,t),f=ft.FromPackageData(u);r(new i([],n.length,f))}catch(e){r(new i([],0,null))}})}function e(n,t,i){var o={data:n,url:t},f=[],e,u;if(n)if(i===r.TileMesh)e=n.processedData,e&&(f=e.getTransferObjects());else if(n.datas)for(u=0;u<n.datas.length;u++)f.push(n.datas[u].buffer);postMessage(o,undefined,f)}function v(n,t,u){var f=null;n?u===r.TileMesh?ot(new Uint8Array(n),u).then(function(n){e(n,t,u)}):(f=et(new Uint8Array(n),u),e(f,t,u)):e(new i([],0,null),t,u)}function st(n,t){var i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState===4&&(i.status>=200&&i.status<300||i.status===1223?v(i.response,n,t):v(null,n,t),i.onreadystatechange=function(){})};i.open("GET",n,!0);i.responseType="arraybuffer";i.send(null)}var u=function(){function n(n){n===void 0&&(n="");this.message=n}return n.prototype.toString=function(){return"Exception: "+this.message},n}(),p=function(){function n(){}return Object.defineProperty(n.prototype,"position",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return 0},enumerable:!1,configurable:!0}),n.prototype.toArray=function(){return null},n.prototype.readByte=function(){return 0},n.prototype.readBytes=function(){return null},n}(),w=function(n){function t(t){var i=n.call(this)||this;return i._i=0,i._d=t,i}return __extends(t,n),Object.defineProperty(t.prototype,"position",{get:function(){return this._i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._d.length},enumerable:!1,configurable:!0}),t.prototype.toArray=function(){return this._d},t.prototype.readByte=function(){return this._i<this._d.length?this._d[this._i++]:-1},t.prototype.readBytes=function(n){var t;n=Math.min(n,this._d.length-this._i);var i=new Uint8Array(n),r=this._d,u=this._i;for(t=0;t<n;t++)i[t]=r[u++];return this._i+=n,i},t}(p),b=function(){function n(n){this._l=0;this._i=0;this.baseStream=n;this._d=n.toArray();this._l=this._d.length;this._canSlice=this._d.buffer&&this._d.buffer.slice!==undefined;this._dv=new DataView(this._d.buffer)}return n.prototype.isEof=function(){return this._i>=this._l},n.prototype.readInt32=function(){var n=this._dv.getInt32(this._i,!0);return this._i+=4,n},n.prototype.readInt16=function(){var n=this._dv.getInt16(this._i,!0);return this._i+=2,n},n.prototype.readSingle=function(){var n=this._dv.getFloat32(this._i,!0);return this._i+=4,n},n.prototype.readDouble=function(){var n=this._dv.getFloat64(this._i,!0);return this._i+=8,n},n.prototype.readByte=function(){return this._d[this._i++]},n.prototype.read=function(n,t,i){var f,e,o,r;if(this._i>=this._l)throw new u("out of total length");for(i=Math.min(i,this._d.length-this._i),f=this._i,this._i+=i,e=n,o=this._d,r=0;r<i;r++)e[r+t]=o[f+r]},n.prototype.readBytes=function(n){var i,r,f,t;if(this._i>=this._l)throw new u("out of total length");if(n=Math.min(n,this._d.length-this._i),i=this._i,this._i+=n,n>32&&this._canSlice)return new Uint8Array(this._d.buffer.slice(i,i+n));for(r=new Uint8Array(n),f=this._d,t=0;t<n;t++)r[t]=f[i+t];return r},n.prototype.readBytesToEnd=function(){return this.readBytes(this._l-this._i)},n.prototype.close=function(){},n.prototype.readString=function(){var n,t;if(this._i>=this._l)throw new u("out of total length");return(n=this.readStringLength(),n<=0)?"":(t=this.readBytes(n),h.GetUtf8String(t,t.length))},n.prototype.readStringLength=function(){for(var r=0,u=[],f,n,t,e,i;;)if(f=this.readByte(),u.push(f),f<127)break;for(n=u.length-1;n>=0;n--){for(t=1,e=0;e<n;e++)t*=127;i=u[n];i>127&&(i-=127);t*=i;r=r+t}return r},n}(),f=function(n){function t(t){return n.call(this,new w(t))||this}return __extends(t,n),t.prototype.readFloats=function(n){var t=this.readBytes(n*4);return new Float32Array(t.buffer)},t.prototype.readInt32s=function(n){var t=this.readBytes(n*4);return new Int32Array(t.buffer)},t}(b),t=function(){function n(n,t,i){this.x=n;this.y=t;this.z=i}return n.Zero=function(){return new n(0,0,0)},n.prototype.multiplyByFloats=function(t,i,r){return new n(this.x*t,this.y*i,this.z*r)},n}(),k=function(){function n(n,t){this.x=n;this.y=t}return n.Zero=function(){return new n(0,0)},n}(),ct=function(){function n(n,i){n===void 0&&(n=t.Zero());i===void 0&&(i=t.Zero());this.min=n;this.max=i}return n.prototype.contains=function(n){return n.x>=this.min.x&&n.x<=this.max.x&&n.y>=this.min.y&&n.y<=this.max.y&&n.z>=this.min.z&&n.z<=this.max.z},n.IntersectsMinMax=function(n,t,i,r){var u=i.x,f=i.y,e=i.z,o=r.x,s=r.y,h=r.z,c=n.x,l=n.y,a=n.z,v=t.x,y=t.y,p=t.z;return o<c||u>v?!1:s<l||f>y?!1:h<a||e>p?!1:!0},n.Intersects=function(t,i){return n.IntersectsMinMax(t.min,t.max,i.min,i.max)},n.CalcRangeFromArray=function(i){var l;if(!i||i.length<=0)return new n(t.Zero(),t.Zero());var r=0,u=0,s=u=r=17976931348623157e292,f=0,e=0,h=e=f=-17976931348623157e292,c=i.data,p=i.length,o=0;for(l=0;l<p;l++){var a=c[o],v=c[o+1],y=c[o+2];s=Math.min(s,a);u=Math.min(u,v);r=Math.min(r,y);h=Math.max(h,a);e=Math.max(e,v);f=Math.max(f,y);o+=3}return new n(new t(s,u,r),new t(h,e,f))},n}(),d=function(){function n(n,t,i){n===void 0&&(n=0);t===void 0&&(t=0);i===void 0&&(i=0);this.v0=n;this.v1=t;this.v2=i}return n.prototype.clone=function(){return new n(this.v0,this.v1,this.v2)},n.ToIndexArray=function(n){for(var f=n.length,i=new Int32Array(f*3),t=0,r=0,u;r<f;)u=n[r].clone(),i[t]=u.v0,i[t+1]=u.v1,i[t+2]=u.v2,r=r+1,t=t+3;return i},n}(),g=function(){function n(n,t,i,r){(n===void 0&&(n=0),t===void 0&&(t=0),i===void 0&&(i=0),r===void 0&&(r=255),this.r=n,this.g=t,this.b=i,this.a=r,arguments.length!=0)&&(n>0&&n<1.01&&(n=n*255),t>0&&t<1.01&&(t=t*255),i>0&&i<1.01&&(i=i*255),r>0&&r<1.01&&(r=r*255),this.r=Math.floor(Math.min(255,n)),this.g=Math.floor(Math.min(255,t)),this.b=Math.floor(Math.min(255,i)),this.a=Math.floor(Math.min(255,r)))}return n}(),o=function(){function n(n,t){this._strideSize=0;this._length=0;this._strideSize=t;this._length=Math.floor(n.length/this._strideSize);this._data=n}return Object.defineProperty(n.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),n.prototype.getAt=function(n){return this.getElemAt(n*this._strideSize)},n.prototype.getToRef=function(n,t){return this.elemToRef(n*this._strideSize,t)},n.prototype.setAt=function(n,t){this.setElemAt(n*this._strideSize,t)},n.prototype.getElemAt=function(){return null},n.prototype.elemToRef=function(){},n.prototype.setElemAt=function(){},n.prototype.toElementArray=function(){var t=[],i,n;if(this._data)for(i=this.length,n=0;n<i;n++)t.push(this.getAt(n));return t},n}(),nt=function(n){function i(t){return n.call(this,t,3)||this}return __extends(i,n),i.Create=function(n){return new i(new Float32Array(n*3))},i.prototype.clone=function(){return new i(new Float32Array(this._data.buffer.slice(0)))},i.prototype.getElemAt=function(n){return new t(this._data[n],this._data[n+1],this._data[n+2])},i.prototype.setElemAt=function(n,t){this._data[n]=t.x;this._data[n+1]=t.y;this._data[n+2]=t.z},i.prototype.elemToRef=function(n,t){t.x=this._data[n];t.y=this._data[n+1];t.z=this._data[n+2]},i}(o),tt=function(n){function t(t){return n.call(this,t,2)||this}return __extends(t,n),t.Create=function(n){return new t(new Float32Array(n*2))},t.prototype.clone=function(){return new t(new Float32Array(this._data.buffer.slice(0)))},t.prototype.getElemAt=function(n){return new k(this._data[n],this._data[n+1])},t.prototype.setElemAt=function(n,t){this._data[n]=t.x;this._data[n+1]=t.y},t.prototype.elemToRef=function(n,t){t.x=this._data[n];t.y=this._data[n+1]},t}(o),it=function(){function n(n,t){this._strideSize=0;this._length=0;this._strideSize=t;this._length=Math.floor(n.length/this._strideSize);this._data=n}return Object.defineProperty(n.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),n.prototype.getAt=function(n){return this.getElemAt(n*this._strideSize)},n.prototype.setAt=function(n,t){this.setElemAt(n*this._strideSize,t)},n.prototype.getToRef=function(n,t){return this.elemToRef(n*this._strideSize,t)},n.prototype.getElemAt=function(){return null},n.prototype.elemToRef=function(){},n.prototype.setElemAt=function(){},n.prototype.toElementArray=function(){var t=[],i,n;if(this._data)for(i=this.length,n=0;n<i;n++)t.push(this.getAt(n));return t},n}(),s=function(n){function t(t){return n.call(this,t,3)||this}return __extends(t,n),t.Create=function(n){return new t(new Int32Array(n*3))},t.prototype.clone=function(){return new t(new Int32Array(this._data.buffer.slice(0)))},t.prototype.getElemAt=function(n){return new d(this._data[n],this._data[n+1],this._data[n+2])},t.prototype.setElemAt=function(n,t){this._data[n]=t.v0;this._data[n+1]=t.v1;this._data[n+2]=t.v2},t.prototype.elemToRef=function(n,t){t.v0=this._data[n];t.v1=this._data[n+1];t.v2=this._data[n+2]},t}(it),h=function(){function n(){}return n.CheckDecoder=function(){if(!this._HasCheckedDecoder){try{this._TextDecoder=eval("new TextDecoder('utf-8')")}catch(n){}this._HasCheckedDecoder=!0}},n.GetUtf8String=function(n,t){if(!n)return"";if(this.CheckDecoder(),t||(t=n.length),this._TextDecoder)return this._TextDecoder.decode(n);var r=void 0,i=void 0,e=void 0,u=void 0,f=void 0,o=void 0;for(r="",e=Math.min(n.length,t),i=0;i<e;){u=n[i++];switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r+=String.fromCharCode(n[i-1]);break;case 12:case 13:f=n[i++];r+=String.fromCharCode((u&31)<<6|f&63);break;case 14:f=n[i++];o=n[i++];r+=String.fromCharCode((u&15)<<12|(f&63)<<6|(o&63)<<0)}}return r},n._HasCheckedDecoder=!1,n._TextDecoder=null,n}(),n=function(){function n(){}return n.ReadColor=function(n){var t=n.readSingle(),i=n.readSingle(),r=n.readSingle(),u=n.readSingle();return new g(t,i,r,u)},n.ReadStringBlock=function(n){var t=n.readInt32(),i=n.readBytes(t);return h.GetUtf8String(i)},n.ReadStringBlockArray=function(t){var r=t.readInt32(),u,i;if(r===0)return null;for(u=new Array(r),i=0;i<r;i++)u[i]=n.ReadStringBlock(t);return u},n.ReadInt32Array=function(n){var t=n.readInt32();return t===0?null:n.readInt32s(t)},n.ReadFloatArray=function(n){var i=n.readInt32(),r,t;if(i===0)return null;for(r=new Float32Array(i),t=0;t<i;t++)r[t]=n.readSingle();return r},n.ReadVector3Array=function(t){return new nt(n.ReadVector3FloatArray(t))},n.ReadVector3FloatArray=function(n){var t=n.readInt32(),i=Math.floor(t/12);return n.readFloats(i*3)},n.ReadVector2Array=function(t){return new tt(n.ReadVector2FloatArray(t))},n.ReadVector2FloatArray=function(n){var t=n.readInt32(),i=Math.floor(t/8);return n.readFloats(i*2)},n.ReadTriangle3Array=function(t){return new s(n.ReadTriangle3IntArray(t))},n.ReadTriangle3IntArray=function(n){var t=n.readInt32(),i=Math.floor(t/12);return n.readInt32s(i*3)},n.ReadCompressIntArray=function(t){var i=n.ReadInt32Array(t),u,r;if(!i)return null;for(u=i.length,r=1;r<u;r++)i[r]+=i[r-1];return i},n.ReadCompressTriangle3Array=function(t){return new s(n.ReadCompressIntArray(t))},n.ReadCompressFloatArray=function(t){var r=t.readInt32(),i;if(r===0)return null;var f=t.readSingle(),e=t.readSingle(),o=n.ReadCompressIntArray(t),u=new Float32Array(r);for(i=0;i<r;i++)u[i]=o[i]*e+f;return u},n.ReadCompressVector3FloatArray=function(t){var f=t.readInt32(),i;if(f===0)return null;var o=n.ReadCompressFloatArray(t),s=n.ReadCompressFloatArray(t),h=n.ReadCompressFloatArray(t),e=3,u=new Float32Array(f*e),r=0;for(i=0;i<f;i++)u[r]=o[i],u[r+1]=s[i],u[r+2]=h[i],r=r+e;return u},n.ReadCompressVector2FloatArray=function(t){var u=t.readInt32(),i;if(u===0)return null;var o=n.ReadCompressFloatArray(t),s=n.ReadCompressFloatArray(t),e=2,f=new Float32Array(u*e),r=0;for(i=0;i<u;i++)f[r]=o[i],f[r+1]=s[i],r=r+e;return f},n}(),rt=function(){function n(){}return n}(),ut=function(){function n(){this.subs=[];this.textureNames=[];this.textureBytes=[]}return n.prototype.getTransferObjects=function(){for(var n,i=[],t=0;t<this.subs.length;t++)n=this.subs[t],n.vertexes&&i.push(n.vertexes.buffer),n.normals&&i.push(n.normals.buffer),n.textureCoords&&i.push(n.textureCoords.buffer),n.indices&&i.push(n.indices.buffer);for(t=0;t<this.textureBytes.length;t++)this.textureBytes[t]&&i.push(this.textureBytes[t].buffer);return i},n.MarkCountInfo=function(n){for(var t,i=0;i<n.subs.length;i++)t=n.subs[i],t._vertCount=t.vertexes.length,t._indiceCount=t.indices.length},n}(),ft=function(){function t(){}return t.FromPackageData=function(n){var u,r,i,f;if(n.length<1)return null;for(u=n[0],r=t.FromMeshBytes(u),i=1;i<n.length;i++)f=n[i],t.ExtractTextureData(r,f);return r},t.FromMeshBytes=function(i){var r=new f(i),u=new ut,o,e;for(r.readInt32(),u.name=n.ReadStringBlock(r),o=r.readInt32(),e=0;e<o;e++)u.subs.push(t.LoadOneSubMesh(r));return u},t.LoadOneSubMesh=function(n){if(!n)return null;var i=n.readInt32();return i===0?null:t.LoadOneSubMeshVersion1(n)},t.LoadOneSubMeshVersion1=function(t){var i=new rt,r;return i.centerX=t.readDouble(),i.centerY=t.readDouble(),i.centerZ=t.readDouble(),i.radius=t.readDouble(),i.rangeList=n.ReadFloatArray(t),i.rangeDataList=n.ReadStringBlockArray(t),i.textureFileName=n.ReadStringBlock(t),r=t.readInt32(),i.vertexes=n.ReadCompressVector3FloatArray(t),r=t.readInt32(),i.textureCoords=n.ReadCompressVector2FloatArray(t),r=t.readInt32(),i.indices=n.ReadCompressIntArray(t),i},t.ExtractTextureData=function(t,i){var r=new f(i),u,e;r.readInt32();u=n.ReadStringBlock(r);e=r.readBytesToEnd();t.textureNames.push(u);t.textureBytes.push(e)},t}(),i=function(){function n(n,t,i){this.datas=n;this.rawDataBytes=t;this.processedData=i}return n}(),r,y;(function(n){n[n.ArrayBuffer=0]="ArrayBuffer";n[n.ArrayBufferOrPackage=1]="ArrayBufferOrPackage";n[n.TileMesh=10]="TileMesh";n[n.Image=100]="Image"})(r||(r={}));try{self&&(importScripts("./gunzip.min.js"),y=function(n){for(var i,r,t=0;t<n.data.urls.length;t++)i=n.data.urls[t],r=n.data.types[t],st(i,r)},self.onmessage=y)}catch(ht){console.log("loader thread fail: "+ht)}})(DrawseeLoader||(DrawseeLoader={}))